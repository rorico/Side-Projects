function parseData(e){for(var t=[],n="University of Waterloo",s="Printer Friendly Page",r=["SEM","TUT","LAB","LEC","TST"],a=e.substring(e.indexOf(n)+n.length,e.indexOf(s)),i=a.split("Exam Information"),l=0;l<i.length-1;l++){for(var u=[],o=i[l].split("\n"),h=[],p=[],f="",c=0;c<o.length;c++){var g=o[c];if(/^[A-Z].+$/.test(g)){var v=g.split(" "),m=v[0]+" "+v[1],d=g.substring(m.length);h=[m,d];break}}for(var c=0;c<o.length;c++){for(var T=0;T<r.length;T++)if(o[c]==r[T]){p.length&&(u.push([f,p]),p=[]),f=r[T];break}/^[MTWTFh]{1,6} \d{1,2}:.+$/.test(o[c])&&(p.push([getClassLength(o[c]),o[c+1],parseDate(o[c+3])]),c+=4)}p.length&&(u.push([f,p]),p=[]),t.push([h,u])}return t}function parseDate(e){for(var t=[],n=e.split(" - "),s=0;s<n.length;s++){var r=n[s].split("/");1==s?t.push(+new Date(r[2],r[0]-1,r[1],23,59,59,999)):t.push(+new Date(r[2],r[0]-1,r[1]))}return t}function getClassLength(e){var t=e.split(" "),n=parseTime(t[1]),s=parseTime(t[3]);return[t[0],n,s]}function parseTime(e){var t=e.split(":"),n=t[0]-0;return t[1].indexOf("PM")>-1&&"12"!=n&&(n+=12),minutes=t[1].slice(0,-2)-0,60*n+minutes}function sendRequest(e,t){chrome.runtime.sendMessage({from:"options",action:e,input:t})}$("#convert").click(function(){var e=$("#class").val();chrome.storage.sync.set({scheduleInfo:parseData(e)}),sendRequest("resetSchedule"),$("#class").val("")});