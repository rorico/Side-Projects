function parseData(e){for(var r=[],a="University of Waterloo",t="Printer Friendly Page",n=["SEM","TUT","LAB","LEC","TST"],s=e.substring(e.indexOf(a)+a.length,e.indexOf(t)),o=s.split("Exam Information"),i=0;i<o.length-1;i++){for(var l=[],c=o[i].split("\n"),m=[],u=[],d="",g=0;g<c.length;g++){var h=c[g];if(/^[A-Z].+$/.test(h)){var f=h.split(" "),p=f[0]+" "+f[1],A=h.substring(p.length);m=[p,A];break}}for(var g=0;g<c.length;g++){for(var v=0;v<n.length;v++)if(c[g]==n[v]){u.length&&(l.push([d,u]),u=[]),d=n[v];break}/^[MTWTFh]{1,6} \d{1,2}:.+$/.test(c[g])&&(u.push([getClassLength(c[g]),c[g+1],parseDate(c[g+3])]),g+=4)}u.length&&(l.push([d,u]),u=[]),r.push([m,l])}return r}function parseDate(e){for(var r=[],a=e.split(" - "),t=0;t<a.length;t++){var n=a[t].split("/");r.push(1==t?+new Date(n[2],n[0]-1,n[1],23,59,59,999):+new Date(n[2],n[0]-1,n[1]))}return r}function getClassLength(e){var r=e.split(" "),a=parseTime(r[1]),t=parseTime(r[3]);return[r[0],a,t]}function parseTime(e){var r=e.split(":"),a=r[0],t=100*a;return r[1].indexOf("PM")>-1&&"12"!=r[0]&&(t+=1200),r[1]=r[1].slice(0,-2),t+=r[1]/.6}function sendRequest(e,r){chrome.runtime.sendMessage({from:"options",action:e,input:r})}$("#convert").click(function(){var e=$("#input").val();chrome.storage.sync.set({scheduleInfo:parseData(e)}),sendRequest("resetSchedule"),$("#input").val("")});