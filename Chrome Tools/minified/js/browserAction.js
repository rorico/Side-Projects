chrome.runtime.getBackgroundPage(function(t){function e(t,e,i,n,a){function r(){c.state=2;var t=$("<div></div>");c.cnt=0;for(var e=0;e<c.list.length;e++){var i;if(n){if(!c.list[e][1])continue;i=c.list[e][0]}else i=c.list[e];var a=$("<div class='log block'>"+i+"</div>");s(a,e),t.append(a),c.cnt++}d.html(t),d.outerWidth($("body").width()-20)}function o(){c.state=1,d.html(e),d.width(d.height())}function s(t,e){t.click(function(t){t.stopPropagation(),a(e),this.remove(),c.cnt--,c.cnt||l()})}function l(){c.state=0,d.remove()}var c={list:t,cnt:0,state:1,destructor:l,restart:r},u="";"right"===i&&(u=" right");var d=$("<div class='topButton block"+u+"'>"+e+"</div>");return $("body").prepend(d),d.width(d.height()),d.click(function(t){t.stopPropagation(),1===c.state?r():2===c.state&&o()}),$("body").click(function(){2===c.state&&o()}),c}function i(){var t=b.allLogs,i=b.numUnread;i&&e(t,"!","left",!0,function(t){d("removeLog",w)})}function n(){var t=b.youtubeVideoNames;S?(S.list=t,t.length?2===S.state&&S.restart():(S.destructor(),S=null)):t.length&&(S=e(t,"&#9658;","right",!1,function(t){d("youtube",t)}))}function a(){var t=+$("#setTimer").val();s(t)}function r(t){var e=new Date;e-x<1e3?(D+=t.toFixed(0),D.length>3&&(D=D.substring(1)),$("#setTimer").val(D)):(D=t,$("#setTimer").val(D)),x=new Date}function o(){s(+$("#setTimer").val())}function s(t){d("setAlarm",t)}function l(t){t>=0&&t<5&&d("removeAlarm",t)}function c(){d("stopAllAlarms")}function u(){d("snooze")}function d(t,e){chrome.runtime.sendMessage({from:"browserAction",action:t,input:e})}function m(t,e,i){var n=t.toLocaleTimeString();$("#alarmText"+e).html("Alarm at "+n),$("#alarm"+e).removeClass("notSet").css({color:g[i],"border-color":g[i]}).bind("click",function(){l(e)})}function v(t,e){$("#alarmText"+t).html("Not Set").css("visibility","visible"),clearInterval(h[t]),$("#alarm"+t).addClass("notSet").unbind("click").css({color:p,"border-color":p})}function f(t){var e="hidden";h[t]=setInterval(function(){e="hidden"===e?"visible":"hidden",$("#alarmText"+t).css("visibility",e)},300)}for(var h=[],b=t,g=t.typeColors,p=t.defaultColor,k=b.alarms,y=b.numMaxAlarms,T="",w=0;w<y;w++)T+="<div id='alarm"+w+"' class='alarm notSet'><div class='alarmTitle'>"+(w+1)+"</div><div id='alarmText"+w+"' class='alarmData'>Not Set</div></div>";$("#alarms").html(T);for(var w=0;w<k.length;w++){var A=k[w];A&&A.state&&(m(A.alarmTime,w,A.type),2==A.state&&f(w))}keyPressInit($("body")),timeLineInit($("#timeLineH"),b);var L=[["S",o],["A",c],["X",u]];addPhrases(L),addNumberListener(function(t){l(t-1)},"D"),addNumberListener(r),i();var S;n(),setTimeout(function(){window.close()},6e4),$("#timerButton").click(a);var x=new Date,D="";chrome.runtime.onMessage.addListener(function(t,e,i){if("background"===t.from)switch(t.action){case"setAlarm":var a=t.input;m(new Date(a[1]),a[0],a[2]);break;case"removeAlarm":var a=t.input;v(a[0],a[1]);break;case"ringing":f(t.input);break;case"youtube":n()}})});