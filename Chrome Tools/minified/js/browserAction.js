chrome.runtime.getBackgroundPage(function(e){function i(){if(y){var e=$("<div id='logHolder' class='block'>!</div>");$("body").prepend(e),e.width(e.height()),e.one("click",n)}}function n(){for(var e=$("<div id='logs'></div>"),n=0;n<A.length;n++)if(!A[n][1]){var r=$("<div class='log block'>"+A[n][0]+"</div>");t(r,n),e.append(r)}var o=$("#logHolder");o.html(e),o.outerWidth($("body").width()-20),o.one("click",function(){this.remove(),i()})}function t(e,i){e.click(function(e){e.stopPropagation(),this.remove(),d("removeLog",i),y--,y||$("#logHolder").remove()})}function r(){var e=+$("#setTimer").val();l(e)}function o(e){var i=new Date;i-L<1e3?(x+=e.toFixed(0),x.length>3&&(x=x.substring(1)),$("#setTimer").val(x)):(x=e,$("#setTimer").val(x)),L=new Date}function a(){l(+$("#setTimer").val())}function l(e){d("setAlarm",e)}function c(e){var i=e-1;i>=0&&i<5&&d("removeAlarm",i)}function s(){d("stopAllAlarms")}function m(){d("snooze")}function d(e,i){chrome.runtime.sendMessage({from:"browserAction",action:e,input:i})}function u(e,i,n){var t=e.toLocaleTimeString();$("#alarmText"+(i+1)).html("Alarm at "+t),$("#alarm"+(i+1)).removeClass("notSet"),$("#alarm"+(i+1)).css({color:b[n],"border-color":b[n]}),$("#alarm"+(i+1)).bind("click",function(){c(i)})}function v(e,i){$("#alarmText"+(e+1)).html("Not Set"),$("#alarm"+(e+1)).addClass("notSet"),$("#alarm"+(e+1)).unbind("click"),$("#alarm"+(e+1)).css({color:k,"border-color":k}),$("#alarmText"+(e+1)).css("visibility","visible"),clearInterval(g[e])}function f(e){var i="hidden";g[e]=setInterval(function(){i="hidden"===i?"visible":"hidden",$("#alarmText"+(e+1)).css("visibility",i)},300)}for(var g=[0,0,0,0,0],h=e,b=e.typeColors,k=e.defaultColor,p=h.alarms,w=0;w<p.length;w++)1==p[w][0]?u(p[w][1],w,p[w][3]):2==p[w][0]&&(u(p[w][1],w,p[w][3]),f(w));timeLineInit($("#timeLineH"),h),keyPressInit($("body"),keyPhrases);var T=[["S",a],["A",s],["X",m]];addPhrases(T),addNumberListener(c,"D"),addNumberListener(o);var A=h.allLogs,y=h.numUnread;i(),setTimeout(function(){window.close()},6e4),$("#timerButton").click(r);var L=new Date,x="";chrome.runtime.onMessage.addListener(function(e,i,n){if("background"===e.from)switch(e.action){case"setAlarm":var t=e.input;u(new Date(t[1]),t[0],t[2]);break;case"removeAlarm":var t=e.input;v(t[0],t[1]);break;case"ringing":f(e.input)}})});