var timeLineInit,timeLineResize;!function(){function i(i,n){H=e(i.width());for(var a="<div id='axisTop'>",r="<div id='axisBot'>",o=0;o<6;o++)a+="<div class='axisPart top"+(5===o?" end":"")+"'></div>",r+="<div class='axisPart bot"+(5===o?" end":"")+"'></div>";a+="</div>",r+="</div>";var s="<div id='"+S+"'><div id='timeLeft'></div><div id='timeLineHolder'>"+a+"<div id='timeLine'></div>"+r+"</div><div id='info'></div></div>";i.append(s),$(".axisPart").outerWidth(H/6),b=n.timeLeft,x=n.startTime,y=n.wastingTime,B=n.url,z=n.title,u(b),O=n.timeLineLength,N=JSON.parse(JSON.stringify(n.timeLine)),t(),addPhrases(keyPhrases),timeLineResize=function(){var n=e(i.width());n!==H&&(H=n,$(".axisPart").outerWidth(H/6),$("#timeLine").empty(),t())},$(window).resize(timeLineResize)}function e(i){return 60*Math.floor((i-30)/60)}function t(){if(R=H,E=0,J=-1,V=0,D=new Date-x,a(-1,!1,D,y)){for(var i=0;i<N.length&&a(i,!1,N[i][0],N[i][1]);i++);a(-2,!1)}d(-1),l()}function n(i){b=i.timeLeft,x=i.startTime,y=i.wastingTime,B=i.url,z=i.title,D=new Date-x,N=[],$("#timeLine").empty(),t()}function a(i,e,t,n){var a=0;if(a=i===-2?R:t/O*H+E,E=a%1,a=Math.floor(a),a<1&&i!==-1)return E+=a,!0;var d=!0;a>=R?(a=R,R=0,d=!1):R-=a;var c="timeLine";i!==-2&&(c+=" wasting"+n,a>=3&&(c+=" timeLineBlock"));var f=$("<div style='width:"+a+"px;' class='"+c+"' id='"+o(i)+"'></div>");return e?$("#timeLine").append(f):$("#timeLine").prepend(f),i!==-2&&s(f,r(i)),d}function r(i){return i-V}function o(i){return i===-2?"timeLineP":"timeLine"+r(i)}function s(i,e){i.click(function(){J=e+V,d(J)}),i.hover(function(){d(e+V)},function(){d(J)})}function d(i,e){clearTimeout(F);var t="";if(i===-1){D=new Date-x;var n=1e3-D%1e3;e?$("#timeSpend").html(h(D,!0)):(t=v(B,D,z),$("#info").html(t)),F=setTimeout(function(){d(i,!0)},n)}else t=v(N[i][2],N[i][0],N[i][3]),$("#info").html(t)}function c(i,e){$("#"+o(i)).removeClass("wasting"+e).addClass("wasting0")}function f(i){x=i.startTime,y=i.wastingTime,B=i.url,z=i.title,N.unshift(i.newest),V++,a(-1,!0,new Date-x,y),d(-1)}function u(i){y&&(i-=new Date-x),i<0&&(i=0),clearTimeout(A),m(i)}function m(i){if($("#timeLeft").html(h(i,!1)),y&&i>0){var e=(i-1)%1e3+1;A=setTimeout(function(){m(i-e)},e)}}function l(){clearInterval(W);var i=O/H;W=setInterval(function(){var i=$("#timeLine div:last-child");i.width(i.width()+1),!i.hasClass("timeLineBlock")&&i.width()>=3&&i.addClass("timeLineBlock");for(var e=$("#timeLine div:first-child");e.length&&e.width()<=0;)e.remove(),e=$("#timeLine div:first-child");e.width(e.width()-1),e.hasClass("timeLineBlock")&&e.width()<3&&e.removeClass("timeLineBlock")},i)}function v(i,e,t){return"<div class='ellipsis'>"+t+"</div><div class='ellipsis'>"+i+"</div>Time spent: <span id='timeSpend'>"+h(e,!0)+"</span>"}function h(i,e){var t=e?Math.floor(i/1e3):Math.ceil(i/1e3);return Math.floor(t/60)+":"+("0"+Math.floor(t%60)).slice(-2)}function L(){C("resetTime")}function w(){C("VIP")}function p(){C("finish")}function g(){C("change",J)}function T(){C("temp")}function P(){C("zero")}function k(){C("antizero")}function M(){C("youtube")}function I(){C("skipAd")}function C(i,e){chrome.runtime.sendMessage({from:"browserAction",action:i,input:e})}var b,x,y,B,z,D,N,O,S="chromeTools_timeLine",A=-1,H=360,R=H,E=0,J=-1,V=0,W=-1,F=-1;keyPhrases=[["ZYXWVUTSRQPONMLKJIHGFEDCBA",L],["VIP",w,18],["FINISH",p,10],["CHANGE",g,6],["TEMP",T],["NO",P],["MO",k,8],["O",I],["P",M]],timeLineInit=i,chrome.runtime.onMessage.addListener(function(i,e,t){if("background"===i.from)switch(i.action){case"timer":u(i.input);break;case"change":var a=i.input;c(a[0],a[1]);break;case"reset":n(i.input);break;case"newPage":f(i.input)}})}();