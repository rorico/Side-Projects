var timeLineInit;!function(){function i(i,a){H=e(i.width());for(var r="<div id='axisTop'>",o="<div id='axisBot'>",s=0;s<6;s++)r+="<div class='axisPart top"+(5===s?" end":"")+"'></div>",o+="<div class='axisPart bot"+(5===s?" end":"")+"'></div>";r+="</div>",o+="</div>";var d="<div id='"+z+"'><div id='timeLeft'></div><div id='timeLineHolder'>"+r+"<div id='timeLine'></div>"+o+"</div><div id='info'></div></div>";return i.append(d),$(".axisPart").outerWidth(H/6),S=a.timeLineLength,t(a),f(b),addPhrases(keyPhrases),timeLineResize=function(){var t=e(i.width());t!==H&&(H=t,$(".axisPart").outerWidth(H/6),$("#timeLine").empty(),n())},chrome.runtime.onMessage.addListener(function(i,e,n){if("background"===i.from)switch(i.action){case"timer":f(i.input);break;case"change":var a=i.input;c(a[0],a[1]);break;case"reset":t(i.input);break;case"newPage":u(i.input)}}),{resize:timeLineResize,update:t}}function e(i){return 60*Math.floor((i-30)/60)}function t(i){b=i.timeLeft,x=i.startTime,y=i.wastingTime,B=i.url,D=i.title,N=new Date-x,O=i.timeLine?JSON.parse(JSON.stringify(i.timeLine)):[],$("#timeLine").empty(),n()}function n(){if(E=H,J=0,R=-1,V=0,N=new Date-x,a(-1,!1,N,y)){for(var i=0;i<O.length&&a(i,!1,O[i][0],O[i][1]);i++);a(-2,!1)}d(-1),l()}function a(i,e,t,n){var a=0;if(a=i===-2?E:t/S*H+J,J=a%1,a=Math.floor(a),a<1&&i!==-1)return J+=a,!0;var d=!0;a>=E?(a=E,E=0,d=!1):E-=a;var c="timeLine";i!==-2&&(c+=" wasting"+n,a>=3&&(c+=" timeLineBlock"));var u=$("<div style='width:"+a+"px;' class='"+c+"' id='"+o(i)+"'></div>");return e?$("#timeLine").append(u):$("#timeLine").prepend(u),i!==-2&&s(u,r(i)),d}function r(i){return i-V}function o(i){return i===-2?"timeLineP":"timeLine"+r(i)}function s(i,e){i.click(function(){R=e+V,d(R)}),i.hover(function(){d(e+V)},function(){d(R)})}function d(i,e){clearTimeout(F);var t="";if(i===-1){N=new Date-x;var n=1e3-N%1e3;e?$("#timeSpend").html(h(N,!0)):(t=v(B,N,D),$("#info").html(t)),F=setTimeout(function(){d(i,!0)},n)}else t=v(O[i][2],O[i][0],O[i][3]),$("#info").html(t)}function c(i,e){$("#"+o(i)).removeClass("wasting"+e).addClass("wasting0")}function u(i){x=i.startTime,y=i.wastingTime,B=i.url,D=i.title,O.unshift(i.newest),V++,a(-1,!0,new Date-x,y),d(-1)}function f(i){y&&(i-=new Date-x),i<0&&(i=0),clearTimeout(A),m(i)}function m(i){if($("#timeLeft").html(h(i,!1)),y&&i>0){var e=(i-1)%1e3+1;A=setTimeout(function(){m(i-e)},e)}}function l(){clearInterval(W);var i=S/H;W=setInterval(function(){var i=$("#timeLine div:last-child");i.width(i.width()+1),!i.hasClass("timeLineBlock")&&i.width()>=3&&i.addClass("timeLineBlock");for(var e=$("#timeLine div:first-child");e.length&&e.width()<=0;)e.remove(),e=$("#timeLine div:first-child");e.width(e.width()-1),e.hasClass("timeLineBlock")&&e.width()<3&&e.removeClass("timeLineBlock")},i)}function v(i,e,t){return"<div class='ellipsis'>"+t+"</div><div class='ellipsis'>"+i+"</div>Time spent: <span id='timeSpend'>"+h(e,!0)+"</span>"}function h(i,e){var t=e?Math.floor(i/1e3):Math.ceil(i/1e3);return Math.floor(t/60)+":"+("0"+Math.floor(t%60)).slice(-2)}function L(){C("resetTime")}function p(){C("VIP")}function w(){C("finish")}function g(){C("change",R)}function P(){C("temp")}function T(){C("zero")}function k(){C("antizero")}function M(){C("youtube")}function I(){C("skipAd")}function C(i,e){chrome.runtime.sendMessage({from:"browserAction",action:i,input:e})}var b,x,y,B,D,N,O,S,z="chromeTools_timeLine",A=-1,H=360,E=H,J=0,R=-1,V=0,W=-1,F=-1;keyPhrases=[["ZYXWVUTSRQPONMLKJIHGFEDCBA",L],["VIP",p,18],["FINISH",w,10],["CHANGE",g,6],["TEMP",P],["NO",T],["MO",k,8],["O",I],["P",M]],timeLineInit=i}();