function prepare(e,n){currentType(e,n)&&blockObj.prepare(n)}function block(e,n,c){var o,t=document.webkitFullscreenElement;return t?"IFRAME"===t.tagName?document.webkitExitFullscreen():o=t:o=document.getElementsByTagName("body")[0],move(o),currentType(e,n)&&blockObj.update(n),blockScreen.addClass("display").focus(),hidden=!1,c(!0),!1}function move(e){blockScreen.parent().get()[0]!==e&&(blockScreen.detach().appendTo(e).focus(),blockObj&&blockObj.resize())}function currentType(e,n){return!(!blockObj||blockObj.type!==e)||(init(e,n),!1)}function init(e,n){blockObj={type:e};var c=function(){};if("time"===e)if("undefined"==typeof timeLineInit||"undefined"==typeof keyPressInit||"undefined"==typeof iframe)console.log(e+" content script missing");else{var o=(keyPressInit(blockScreen),timeLineInit(blockScreen,n)),t=iframe(blockScreen,n);blockObj.update=function(e){o.update(e)},blockObj.prepare=function(e){t.update(e)},blockObj.resize=function(){o.resize(),t.resize()}}else if("undefined"==typeof scheduleInit)console.log(e+" content script missing");else{n.weekSchedule=weekSchedule;var i=scheduleInit(blockScreen,n);blockObj.update=c,blockObj.prepare=c,blockObj.resize=i.resize}$(window).resize(blockObj.resize)}function unblock(){$("#"+blockId).removeClass("display").blur(),hidden=!0}function weekSchedule(e,n){sendRequest("weekSchedule",e,n)}function sendRequest(e,n,c){chrome.runtime.sendMessage({from:"content",action:e,input:n},c)}var blockId="chromeTools_block",hidden=!1,blockObj,blockScreen=$("<div id='"+blockId+"'></div>");$("body").append(blockScreen),$(document).on("webkitfullscreenchange",function(){hidden||move(document.webkitFullscreenElement||document.getElementsByTagName("body")[0])}),chrome.runtime.onMessage.addListener(function(e,n,c){switch(e.action){case"prepare":prepare(e.type,e.info);break;case"block":return block(e.type,e.info,c);case"unblock":unblock();break;case"ping":var o={time:"undefined"!=typeof timeLineInit,schedule:"undefined"!=typeof scheduleInit};c(o)}});