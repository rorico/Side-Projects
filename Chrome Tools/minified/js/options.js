chrome.runtime.getBackgroundPage(function(e){function t(e){s=e.maxLevel;for(var t="",n=0;n<=s;n++){var r=s===n?" selected":"";t+="<option value='"+n+"'"+r+">"+n+"</option>"}$("#nameLevel").html(t).off("change").change(function(){s=parseInt(this.value),a(e)}),e.data?a(e):l(e.name,function(t){var n=[];Object.keys(t).sort().forEach(function(e){n=n.concat(t[e])}),e.data=n,a(e)})}function a(e){var t=e.processData(e.data,s);n(t.series,t.zoom,t.options)}function n(e,t,a){if(e){var n={chart:{renderTo:"redirects",zoomType:"x",type:"column"},title:{text:"Redirects"},xAxis:{type:"datetime"},yAxis:{title:{text:"Number of Redirects"}},series:e,plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null},column:{stacking:"normal",pointPadding:0,borderWidth:0}}};for(var r in a)n[r]=a[r];var o=new Highcharts.Chart(n);t&&(o.xAxis[0].setExtremes(t[0],t[1]),o.showResetZoom())}}function r(e){var t=Math.floor(e/1e3);return Math.floor(t/60)+":"+("0"+Math.floor(t%60)).slice(-2)}var o,i;!function(){function e(e,t){var a=e[e.length-1][0];t===a?e[e.length-1][1]++:(t-a>l&&(e.push([a+l,0]),e.push([t-l,0])),a=t,e.push([t,1]))}function t(e,t,a){do{var n,r=s(t),o=r+l;n=t+a>o?o-t:a;var i=e[e.length-1][0];r===i?e[e.length-1][1]+=n:(r-i>l&&(e.push([i+l,0]),e.push([r-l,0])),i=r,e.push([r,n])),a-=n}while(a)}function a(e,t){e="string"==typeof e?e:"unnamed";var a=e;switch(t){case 2:a=n(e);break;case 1:var r=n(e),o="reddit.com/r/",i=e.indexOf(o);if(i!==-1){var s=e.substring(i+o.length),l=s.indexOf("/"),h=s.substring(0,l===-1?s.length:l);a=r+" -> "+h}else a=r;break;case 0:a=e}return a}function n(e){var t=e.split("/");if(t[2]){var a=t[2].split(".");return a[a.length-2]?a[a.length-2]:t[2]}return e}function s(e){var t=new Date(e);return t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0),+t}var l=36e5,h=6048e5;o=function(t,n){var r=[],o=[];if(t&&t.length){for(var i={},c=0,u=s(t[0][0])-l,v=[[u,0]],f=0;f<t.length;f++){var g=a(t[f][1],n),p=s(t[f][0]),d=i[g];if(void 0===d){d=c++,i[g]=d;var m=[[p-l,0]];r.push({name:g,data:m})}var x=r[d].data;e(x,p),e(v,p)}r.push({name:"all",data:v,visible:!1});for(var b=0;b<r.length;b++){var x=r[b].data;x.push([x[x.length-1][0]+l,0])}var y=v[v.length-1][0];o=[y-h,y]}return{series:r,zoom:o}},i=function(e,n){console.log(e);var o=[],i=[],c={tooltip:{pointFormatter:function(){return"<span style='color:"+this.color+"'>\u25cf</span> "+this.series.name+": <b>"+r(this.y)+"</b><br/>"}}};if(e&&e.length){for(var u={},v=0,f=0;f<e.length;f++){var g=e[f][4];if(g){var p=3===n?"Wasting Level "+e[f][1]:a(e[f][2],n),d=u[p];if(void 0===d){d=v++,u[p]=d;var m=[[s(g)-l,0]];o.push({name:p,data:m})}var x=o[d].data;t(x,g,e[f][0])}}for(var b=-(1/0),y=0;y<o.length;y++){var x=o[y].data,O=x[x.length-1][0];x.push([O+l,0]),O>b&&(b=O)}i=[b-h,b]}return{series:o,zoom:i,options:c}}}();var s,l=e.getData,h=[{name:"timeLine",maxLevel:3,processData:i},{name:"redirect",maxLevel:2,processData:o}];if(Highcharts.setOptions({global:{timezoneOffset:(new Date).getTimezoneOffset()}}),h.length){for(var c,u=0;u<h.length;u++){var v=h[u].name;c+="<option value='"+u+"'>"+v+"</option>"}$("#dataType").html(c).change(function(){t(h[this.value])}),t(h[0])}});