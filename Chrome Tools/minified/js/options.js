chrome.runtime.getBackgroundPage(function(t){function e(t){s=t.maxLevel;for(var e="",n=0;n<=s;n++){var r=s===n?" selected":"";e+="<option value='"+n+"'"+r+">"+n+"</option>"}$("#nameLevel").html(e).off("change").change(function(){s=parseInt(this.value),a(t)}),t.data?a(t):l(t.name,function(e){var n=[];Object.keys(e).sort().forEach(function(t){n=n.concat(e[t])}),t.data=n,a(t)})}function a(t){var e=t.processData(t.data,s);n(e.series,e.zoom,e.options)}function n(t,e,a){if(t){var n={chart:{renderTo:"highcharts",zoomType:"x",type:"column"},xAxis:{type:"datetime"},series:t,plotOptions:{area:{fillColor:{linearGradient:{x1:0,y1:0,x2:0,y2:1},stops:[[0,Highcharts.getOptions().colors[0]],[1,Highcharts.Color(Highcharts.getOptions().colors[0]).setOpacity(0).get("rgba")]]},marker:{radius:2},lineWidth:1,states:{hover:{lineWidth:1}},threshold:null},column:{stacking:"normal",pointPadding:0,borderWidth:0}}};for(var r in a)n[r]=a[r];var i=new Highcharts.Chart(n);e&&(i.xAxis[0].setExtremes(e[0],e[1]),i.showResetZoom())}}function r(t){var e=Math.floor(t/1e3);return Math.floor(e/60)+":"+("0"+Math.floor(e%60)).slice(-2)}var i,o;!function(){function t(t,e){var a=t[t.length-1][0];e===a?t[t.length-1][1]++:(e-a>l&&(t.push([a+l,0]),t.push([e-l,0])),a=e,t.push([e,1]))}function e(t,e,a){do{var n,r=s(e),i=r+l;n=e+a>i?i-e:a;var o=t[t.length-1][0];r===o?t[t.length-1][1]+=n:(r-o>l&&(t.push([o+l,0]),t.push([r-l,0])),o=r,t.push([r,n])),a-=n}while(a)}function a(t,e){t="string"==typeof t?t:"unnamed";var a=t;switch(e){case 2:a=n(t);break;case 1:var r=n(t),i="reddit.com/r/",o=t.indexOf(i);if(o!==-1){var s=t.substring(o+i.length),l=s.indexOf("/"),h=s.substring(0,l===-1?s.length:l);a=r+" -> "+h}else a=r;break;case 0:a=t}return a}function n(t){var e=t.split("/");if(e[2]){var a=e[2].split(".");return a[a.length-2]?a[a.length-2]:e[2]}return t}function s(t){var e=new Date(t);return e.setMinutes(0),e.setSeconds(0),e.setMilliseconds(0),+e}var l=36e5,h=6048e5;i=function(e,n){var r=[],i=[],o={title:{text:"Redirects"},yAxis:{title:{text:"Number of Redirects"}}};if(e&&e.length){for(var c={},u=0,f=0;f<e.length;f++){var v=a(e[f][1],n),g=s(e[f][0]),p=c[v];if(void 0===p){p=u++,c[v]=p;var m=[[g-l,0]];r.push({name:v,data:m})}var d=r[p].data;t(d,g)}for(var x=-(1/0),b=0;b<r.length;b++){var d=r[b].data,y=d[d.length-1][0];d.push([y+l,0]),y>x&&(x=y)}i=[x-h,x]}return{series:r,zoom:i,options:o}},o=function(t,n){var i=[],o=[],c={title:{text:"TimeLine Wasting Time"},yAxis:{title:{text:"Time Spent"},labels:{formatter:function(){return console.log(this),r(this.value)}}},tooltip:{pointFormatter:function(){return"<span style='color:"+this.color+"'>\u25cf</span> "+this.series.name+": <b>"+r(this.y)+"</b><br/>"}}};if(t&&t.length){for(var u={},f=0,v=0;v<t.length;v++){var g=t[v][4];if(g){var p=3===n?"Wasting Level "+t[v][1]:a(t[v][2],n),m=u[p];if(void 0===m){m=f++,u[p]=m;var d=[[s(g)-l,0]];i.push({name:p,data:d})}var x=i[m].data;e(x,g,t[v][0])}}for(var b=-(1/0),y=0;y<i.length;y++){var x=i[y].data,O=x[x.length-1][0];x.push([O+l,0]),O>b&&(b=O)}o=[b-h,b]}return{series:i,zoom:o,options:c}}}();var s,l=t.getData,h=[{name:"timeLine",maxLevel:3,processData:o},{name:"redirect",maxLevel:2,processData:i}];if(Highcharts.setOptions({global:{timezoneOffset:(new Date).getTimezoneOffset()}}),h.length){for(var c,u=0;u<h.length;u++){var f=h[u].name;c+="<option value='"+u+"'>"+f+"</option>"}$("#dataType").html(c).change(function(){e(h[this.value])}),e(h[0])}});